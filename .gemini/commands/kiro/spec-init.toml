description = "詳細なプロジェクト記述から新しい仕様書を初期化する"
prompt = """
<meta>
description: 詳細なプロジェクト記述から新しい仕様書を初期化する
argument-hint: <project-description:$ARGUMENTS>
arguments: {{args}}
</meta>

# 仕様初期化 (Spec Initialization)

<background_information>
- **ミッション**: 新しい仕様のためのディレクトリ構造とメタデータを作成し、仕様駆動開発の第1フェーズを初期化する
- **成功基準**:
  - プロジェクト記述から適切な機能名を生成する
  - 競合のないユニークな仕様構造を作成する
  - 次のフェーズ（要件生成）への明確なパスを提供する
</background_information>

<instructions>
## コアタスク
プロジェクト記述 ($ARGUMENTS) からユニークな機能名を生成し、仕様構造を初期化する。

## 実行ステップ
1. **一意性の確認**: `.kiro/specs/` で名前の競合を確認する（必要に応じて番号サフィックスを追加）
2. **ディレクトリ作成**: `.kiro/specs/[feature-name]/`
3. **テンプレートを使用したファイル初期化**:
   - `.kiro/settings/templates/specs/init.json` を読み込む
   - `.kiro/settings/templates/specs/requirements-init.md` を読み込む
   - プレースホルダーを置換する:
     - `{{FEATURE_NAME}}` → 生成された機能名
     - `{{TIMESTAMP}}` → 現在のISO 8601タイムスタンプ
     - `{{PROJECT_DESCRIPTION}}` → $ARGUMENTS
   - `spec.json` と `requirements.md` を仕様ディレクトリに書き込む

## 重要な制約
- この段階で要件/設計/タスクを生成しないこと
- 段階的な開発原則に従うこと
- フェーズの分離を厳密に維持すること
- このフェーズでは初期化のみを実行すること
</instructions>

## ツールガイダンス
- **Glob** を使用して既存の仕様ディレクトリの名前の一意性を確認する
- **Read** を使用してテンプレート `init.json` と `requirements-init.md` を取得する
- **Write** を使用してプレースホルダー置換後に `spec.json` と `requirements.md` を作成する
- ファイル書き込み操作の前に検証を実行する

## 出力記述
`spec.json.language` で指定された言語で以下の構造で出力を提供する:

1. **生成された機能名**: `feature-name` 形式と1〜2文の根拠
2. **プロジェクト要約**: 短い要約（1文）
3. **作成されたファイル**: フルパスの箇条書きリスト
4. **次のステップ**: `/kiro:spec-requirements <feature-name>` を示すコマンドブロック
5. **ノート**: なぜ初期化のみが行われたかを説明する（フェーズ分離について2〜3文）

**フォーマット要件**:
- Markdown見出し (##, ###) を使用する
- コマンドをコードブロックで囲む
- 全体の出力を簡潔に保つ（250語以内）
- `spec.json.language` に従った明確でプロフェッショナルな言語を使用する

## 安全性とフォールバック
- **曖昧な機能名**: 機能名の生成が不明確な場合、2〜3のオプションを提案し、ユーザーに選択を求める
- **テンプレート欠落**: テンプレートファイルが `.kiro/settings/templates/specs/` に存在しない場合、特定の欠落ファイルパスと共にエラーを報告し、リポジトリ設定の確認を提案する
- **ディレクトリ競合**: 機能名が既に存在する場合、数値サフィックス（例: `feature-name-2`）を追加し、自動競合解決をユーザーに通知する
- **書き込み失敗**: 特定のパスと共にエラーを報告し、権限またはディスク容量の確認を提案する

arguments: {{args}}
"""