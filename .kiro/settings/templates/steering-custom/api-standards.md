# API標準

[目的: 命名、構造、認証、バージョニング、およびエラーの一貫したAPIパターン]

## 哲学
- 予測可能なリソース指向設計を優先する
- 契約において明示的であること; 破壊的変更を最小限にする
- デフォルトで安全（認証ファースト、最小特権）

## エンドポイントパターン
```
/{version}/{resource}[/{id}][/{sub-resource}]
```
例:
- `/api/v1/users`
- `/api/v1/users/:id`
- `/api/v1/users/:id/posts`

HTTP動詞:
- GET (読み取り、安全、冪等)
- POST (作成)
- PUT/PATCH (更新)
- DELETE (削除、冪等)

## リクエスト/レスポンス

リクエスト (典型的):
```json
{ "data": { ... }, "metadata": { "requestId": "..." } }
```

成功:
```json
{ "data": { ... }, "meta": { "timestamp": "...", "version": "..." } }
```

エラー:
```json
{ "error": { "code": "ERROR_CODE", "message": "...", "field": "optional" } }
```
(ルールのために error-handling を参照)

## ステータスコード (パターン)
- 2xx: 成功 (200 読み取り, 201 作成, 204 削除)
- 4xx: クライアントの問題 (400 検証, 401/403 認証, 404 欠落)
- 5xx: サーバーの問題 (500 汎用, 503 利用不可)
結果を最もよく反映するステータスを選択する。

## 認証
- 標準的な場所での資格情報
```
Authorization: Bearer {token}
```
- ビジネスロジックの前に未認証を拒否する

## バージョニング
- URL/ヘッダー/メディアタイプによるバージョン管理
- 破壊的変更 → 新しいバージョン
- 非破壊的変更 → 同じバージョン
- 非推奨期間と連絡を提供する

## ページネーション/フィルタリング (該当する場合)
- ページネーション: `page`, `pageSize` またはカーソルベース
- フィルタリング: 明示的なクエリパラメータ
- ソート: `sort=field:asc|desc`
ページネーションメタデータを `meta` で返す。

---
_エンドポイントカタログではなく、パターンと決定に焦点を当てる_